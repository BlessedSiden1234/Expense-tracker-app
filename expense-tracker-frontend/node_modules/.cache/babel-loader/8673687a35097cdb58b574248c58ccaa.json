{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\USER\\\\Projects\\\\expense-tracker-app\\\\expense-tracker-frontend\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\USER\\\\Projects\\\\expense-tracker-app\\\\expense-tracker-frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\USER\\\\Projects\\\\expense-tracker-app\\\\expense-tracker-frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\USER\\\\Projects\\\\expense-tracker-app\\\\expense-tracker-frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\USER\\\\Projects\\\\expense-tracker-app\\\\expense-tracker-frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\USER\\\\Projects\\\\expense-tracker-app\\\\expense-tracker-frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\USER\\\\Projects\\\\expense-tracker-app\\\\expense-tracker-frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\USER\\\\Projects\\\\expense-tracker-app\\\\expense-tracker-frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\USER\\\\Projects\\\\expense-tracker-app\\\\expense-tracker-frontend\\\\src\\\\components\\\\Loan\\\\AddLoanForm.js\";\nimport React, { Component } from \"react\";\nimport DatePicker from \"react-datepicker\";\nimport moment from \"moment\";\nimport $ from \"jquery\";\nimport Loader from \"./../Common/Loader\";\nimport * as db from \"../../firebase/db\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport \"../../assets/css/form.css\";\n\nvar AddLoanForm =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AddLoanForm, _Component);\n\n  function AddLoanForm(props) {\n    var _this;\n\n    _classCallCheck(this, AddLoanForm);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AddLoanForm).call(this, props));\n    _this.state = {\n      date: moment(),\n      day: moment().day,\n      amount: \"\",\n      loanType: \"Given\",\n      person: \"\",\n      reason: \"\",\n      status: \"Pending\",\n      uid: _this.props.user.uid,\n      dataSaved: false\n    };\n    _this.handleSubmit = _this.handleSubmit.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handelDateChange = _this.handelDateChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(AddLoanForm, [{\n    key: \"handleSubmit\",\n    value: function handleSubmit(event) {\n      var _this2 = this;\n\n      event.preventDefault();\n      var userId = this.props.user.userId; // ‚úÖ same as AddExpense\n\n      var payload = {\n        userId: userId,\n        lender: this.state.person,\n        amount: Number(this.state.amount),\n        startDate: $(\".date\").val(),\n        endDate: null,\n        status: this.state.status === \"Settled\" ? \"paid\" : \"active\",\n        notes: this.state.reason,\n        loanType: this.state.loanType,\n        // optional (frontend use)\n        day: moment($(\".date\").val()).day()\n      };\n      console.log(\"üöÄ Sending loan payload:\", payload);\n      fetch(\"http://localhost:7071/api/addLoan\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(payload)\n      }).then(\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee(res) {\n          var data;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  console.log(\"üì° Response status:\", res.status);\n                  console.log(\"üì° Response ok:\", res.ok);\n                  _context.prev = 2;\n                  _context.next = 5;\n                  return res.json();\n\n                case 5:\n                  data = _context.sent;\n                  console.log(\"üì¶ Response body:\", data);\n                  _context.next = 12;\n                  break;\n\n                case 9:\n                  _context.prev = 9;\n                  _context.t0 = _context[\"catch\"](2);\n                  console.error(\"‚ùå Failed to parse JSON response\", _context.t0);\n\n                case 12:\n                  if (res.ok) {\n                    _context.next = 14;\n                    break;\n                  }\n\n                  throw new Error(data && data.error || \"AddLoan API failed\");\n\n                case 14:\n                  return _context.abrupt(\"return\", data);\n\n                case 15:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, null, [[2, 9]]);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()).then(function (result) {\n        console.log(\"‚úÖ Loan saved successfully:\", result);\n\n        _this2.setState({\n          date: moment(),\n          day: moment().day,\n          amount: \"\",\n          loanType: \"Given\",\n          person: \"\",\n          reason: \"\",\n          status: \"Pending\",\n          dataSaved: true\n        });\n      }).catch(function (err) {\n        console.error(\"‚ùå Add loan error (frontend):\", err);\n        alert(\"Failed to save loan ‚Äî check console\");\n      });\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(e) {\n      // If you are using babel, you can use ES 6 dictionary syntax { [e.target.name] = e.target.value }\n      var change = {};\n      change[e.target.name] = e.target.value;\n      this.setState(change);\n    }\n  }, {\n    key: \"handelDateChange\",\n    value: function handelDateChange(date) {\n      this.setState({\n        date: date\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.props.settings) {\n        var inputNightMode = {\n          background: \"#2c2b2b\",\n          color: \"#a9a0a0\",\n          border: \"1px solid #9b8c8cc7\"\n        };\n        var inputDayMode = {\n          background: \"#fff\",\n          color: \"#495057\"\n        };\n        return React.createElement(\"form\", {\n          onSubmit: this.handleSubmit,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"form-group row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"col-sm-2 col-xs-6 col-form-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, \"Date\")), React.createElement(\"div\", {\n          className: \"col-sm-10 col-xs-6\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, React.createElement(DatePicker, {\n          className: \"form-control date \" + (this.props.settings.mode === \"night\" ? \"inputNightMode\" : \"inputDayMode\"),\n          name: \"date\",\n          selected: this.state.date,\n          onChange: this.handelDateChange.bind(this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }))), React.createElement(\"div\", {\n          className: \"form-group row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"col-sm-2 col-xs-6 col-form-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }, \"Amount\")), React.createElement(\"div\", {\n          className: \"col-sm-10 col-xs-6\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          className: \"form-control\",\n          required: true,\n          type: \"number\",\n          name: \"amount\",\n          onChange: this.handleChange.bind(this),\n          value: this.state.amount,\n          style: this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }))), React.createElement(\"div\", {\n          className: \"form-group row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"col-sm-2 col-xs-6 col-form-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, \"Loan Type\")), React.createElement(\"div\", {\n          className: \"col-sm-10 col-xs-6\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        }, React.createElement(\"select\", {\n          className: \"form-control\",\n          name: \"loanType\",\n          value: this.state.loanType,\n          onChange: this.handleChange.bind(this),\n          style: this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158\n          },\n          __self: this\n        }, React.createElement(\"option\", {\n          value: \"Given\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        }, \"Given\"), React.createElement(\"option\", {\n          value: \"Taken\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166\n          },\n          __self: this\n        }, \"Taken\")))), React.createElement(\"div\", {\n          className: \"form-group row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"col-sm-2 col-xs-6 col-form-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        }, \"Person\")), React.createElement(\"div\", {\n          className: \"col-sm-10 col-xs-6\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          className: \"form-control\",\n          required: true,\n          type: \"text\",\n          name: \"person\",\n          onChange: this.handleChange.bind(this),\n          value: this.state.person,\n          style: this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175\n          },\n          __self: this\n        }))), React.createElement(\"div\", {\n          className: \"form-group row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"col-sm-2 col-xs-6 col-form-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188\n          },\n          __self: this\n        }, \"Status\")), React.createElement(\"div\", {\n          className: \"col-sm-10 col-xs-6\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190\n          },\n          __self: this\n        }, React.createElement(\"select\", {\n          className: \"form-control\",\n          name: \"status\",\n          value: this.state.status,\n          onChange: this.handleChange.bind(this),\n          style: this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191\n          },\n          __self: this\n        }, React.createElement(\"option\", {\n          value: \"Pending\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198\n          },\n          __self: this\n        }, \"Pending\"), React.createElement(\"option\", {\n          value: \"Settled\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199\n          },\n          __self: this\n        }, \"Settled\")))), React.createElement(\"div\", {\n          className: \"form-group row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 203\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"col-sm-2 col-xs-6 col-form-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 205\n          },\n          __self: this\n        }, \"Reason\")), React.createElement(\"div\", {\n          className: \"col-sm-10 col-xs-6\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 207\n          },\n          __self: this\n        }, React.createElement(\"textarea\", {\n          className: \"form-control\",\n          type: \"text\",\n          required: true,\n          name: \"reason\",\n          onChange: this.handleChange.bind(this),\n          value: this.state.reason,\n          style: this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208\n          },\n          __self: this\n        }))), this.state.dataSaved ? React.createElement(\"span\", {\n          className: \"bg-success success-msg\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }, \" Data saved successfully\") : React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223\n          },\n          __self: this\n        }), React.createElement(\"button\", {\n          className: \"btn btn-primary float-right\",\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }, \"save\"));\n      } else {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        }, React.createElement(Loader, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 233\n          },\n          __self: this\n        }));\n      }\n    }\n  }]);\n\n  return AddLoanForm;\n}(Component);\n\nexport default AddLoanForm;","map":{"version":3,"sources":["C:\\Users\\USER\\Projects\\expense-tracker-app\\expense-tracker-frontend\\src\\components\\Loan\\AddLoanForm.js"],"names":["React","Component","DatePicker","moment","$","Loader","db","AddLoanForm","props","state","date","day","amount","loanType","person","reason","status","uid","user","dataSaved","handleSubmit","bind","handleChange","handelDateChange","event","preventDefault","userId","payload","lender","Number","startDate","val","endDate","notes","console","log","fetch","method","headers","body","JSON","stringify","then","res","ok","json","data","error","Error","result","setState","catch","err","alert","e","change","target","name","value","settings","inputNightMode","background","color","border","inputDayMode","mode"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport DatePicker from \"react-datepicker\";\r\nimport moment from \"moment\";\r\nimport $ from \"jquery\";\r\n\r\nimport Loader from \"./../Common/Loader\";\r\n\r\nimport * as db from \"../../firebase/db\";\r\n\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nimport \"../../assets/css/form.css\";\r\n\r\nclass AddLoanForm extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            date: moment(),\r\n            day: moment().day,\r\n            amount: \"\",\r\n            loanType: \"Given\",\r\n            person: \"\",\r\n            reason: \"\",\r\n            status: \"Pending\",\r\n            uid: this.props.user.uid,\r\n            dataSaved: false\r\n        };\r\n\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handelDateChange = this.handelDateChange.bind(this);\r\n    }\r\n\r\n   handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    const userId = this.props.user.userId; // ‚úÖ same as AddExpense\r\n\r\n    const payload = {\r\n        userId,\r\n        lender: this.state.person,\r\n        amount: Number(this.state.amount),\r\n        startDate: $(\".date\").val(),\r\n        endDate: null,\r\n        status: this.state.status === \"Settled\" ? \"paid\" : \"active\",\r\n        notes: this.state.reason,\r\n        loanType: this.state.loanType, // optional (frontend use)\r\n        day: moment($(\".date\").val()).day()\r\n    };\r\n\r\n    console.log(\"üöÄ Sending loan payload:\", payload);\r\n\r\n   fetch(\"http://localhost:7071/api/addLoan\", {\r\n    method: \"POST\",\r\n    headers: {\r\n        \"Content-Type\": \"application/json\"\r\n    },\r\n    body: JSON.stringify(payload)\r\n})\r\n    .then(async res => {\r\n        console.log(\"üì° Response status:\", res.status);\r\n        console.log(\"üì° Response ok:\", res.ok);\r\n\r\n        let data;\r\n        try {\r\n            data = await res.json();\r\n            console.log(\"üì¶ Response body:\", data);\r\n        } catch (e) {\r\n            console.error(\"‚ùå Failed to parse JSON response\", e);\r\n        }\r\n\r\n        if (!res.ok) {\r\n            throw new Error(data && data.error || \"AddLoan API failed\");\r\n        }\r\n\r\n        return data;\r\n    })\r\n    .then(result => {\r\n        console.log(\"‚úÖ Loan saved successfully:\", result);\r\n\r\n        this.setState({\r\n            date: moment(),\r\n            day: moment().day,\r\n            amount: \"\",\r\n            loanType: \"Given\",\r\n            person: \"\",\r\n            reason: \"\",\r\n            status: \"Pending\",\r\n            dataSaved: true\r\n        });\r\n    })\r\n    .catch(err => {\r\n        console.error(\"‚ùå Add loan error (frontend):\", err);\r\n        alert(\"Failed to save loan ‚Äî check console\");\r\n    });\r\n\r\n}\r\n\r\n\r\n    handleChange(e) {\r\n        // If you are using babel, you can use ES 6 dictionary syntax { [e.target.name] = e.target.value }\r\n        var change = {};\r\n        change[e.target.name] = e.target.value;\r\n        this.setState(change);\r\n    }\r\n\r\n    handelDateChange(date) {\r\n        this.setState({\r\n            date: date\r\n        });\r\n    }\r\n\r\n    render() {\r\n        if (this.props.settings) {\r\n            const inputNightMode = { background: \"#2c2b2b\", color: \"#a9a0a0\", border: \"1px solid #9b8c8cc7\" };\r\n\r\n            const inputDayMode = { background: \"#fff\", color: \"#495057\" };\r\n            return (\r\n                <form onSubmit={this.handleSubmit}>\r\n                    <div className=\"form-group row\">\r\n                        <label className=\"col-sm-2 col-xs-6 col-form-label\">\r\n                            <span>Date</span>\r\n                        </label>\r\n                        <div className=\"col-sm-10 col-xs-6\">\r\n                            <DatePicker\r\n                                className={\r\n                                    \"form-control date \" +\r\n                                    (this.props.settings.mode === \"night\" ? \"inputNightMode\" : \"inputDayMode\")\r\n                                }\r\n                                name=\"date\"\r\n                                selected={this.state.date}\r\n                                onChange={this.handelDateChange.bind(this)}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-group row\">\r\n                        <label className=\"col-sm-2 col-xs-6 col-form-label\">\r\n                            <span>Amount</span>\r\n                        </label>\r\n                        <div className=\"col-sm-10 col-xs-6\">\r\n                            <input\r\n                                className=\"form-control\"\r\n                                required\r\n                                type=\"number\"\r\n                                name=\"amount\"\r\n                                onChange={this.handleChange.bind(this)}\r\n                                value={this.state.amount}\r\n                                style={this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-group row\">\r\n                        <label className=\"col-sm-2 col-xs-6 col-form-label\">\r\n                            <span>Loan Type</span>\r\n                        </label>\r\n                        <div className=\"col-sm-10 col-xs-6\">\r\n                            <select\r\n                                className=\"form-control\"\r\n                                name=\"loanType\"\r\n                                value={this.state.loanType}\r\n                                onChange={this.handleChange.bind(this)}\r\n                                style={this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode}\r\n                            >\r\n                                <option value=\"Given\">Given</option>\r\n                                <option value=\"Taken\">Taken</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-group row\">\r\n                        <label className=\"col-sm-2 col-xs-6 col-form-label\">\r\n                            <span>Person</span>\r\n                        </label>\r\n                        <div className=\"col-sm-10 col-xs-6\">\r\n                            <input\r\n                                className=\"form-control\"\r\n                                required\r\n                                type=\"text\"\r\n                                name=\"person\"\r\n                                onChange={this.handleChange.bind(this)}\r\n                                value={this.state.person}\r\n                                style={this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-group row\">\r\n                        <label className=\"col-sm-2 col-xs-6 col-form-label\">\r\n                            <span>Status</span>\r\n                        </label>\r\n                        <div className=\"col-sm-10 col-xs-6\">\r\n                            <select\r\n                                className=\"form-control\"\r\n                                name=\"status\"\r\n                                value={this.state.status}\r\n                                onChange={this.handleChange.bind(this)}\r\n                                style={this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode}\r\n                            >\r\n                                <option value=\"Pending\">Pending</option>\r\n                                <option value=\"Settled\">Settled</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-group row\">\r\n                        <label className=\"col-sm-2 col-xs-6 col-form-label\">\r\n                            <span>Reason</span>\r\n                        </label>\r\n                        <div className=\"col-sm-10 col-xs-6\">\r\n                            <textarea\r\n                                className=\"form-control\"\r\n                                type=\"text\"\r\n                                required\r\n                                name=\"reason\"\r\n                                onChange={this.handleChange.bind(this)}\r\n                                value={this.state.reason}\r\n                                style={this.props.settings.mode === \"night\" ? inputNightMode : inputDayMode}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {this.state.dataSaved ? (\r\n                        <span className=\"bg-success success-msg\"> Data saved successfully</span>\r\n                    ) : (\r\n                        <span />\r\n                    )}\r\n                    <button className=\"btn btn-primary float-right\" type=\"submit\">\r\n                        save\r\n                    </button>\r\n                </form>\r\n            );\r\n        } else {\r\n            return (\r\n                <div>\r\n                    <Loader />\r\n                </div>\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nexport default AddLoanForm;\r\n"]},"metadata":{},"sourceType":"module"}